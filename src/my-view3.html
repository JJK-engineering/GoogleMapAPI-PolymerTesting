<!-- my-view3.html  testing google-maps-api for hydropower decision support system use -->

<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="shared-styles.html">
<link rel="import" href="../bower_components/google-apis/google-maps-api.html">

<dom-module id="my-view3">
    <template>
    <style include="shared-styles">
     :host {
	 display: block;
         padding: 10px;
     }
     #map2 {                    <!-- testing -->
	 position: absolute;
	 height: 300px;
	 width: 500px;
     }
     #map {
	 position: absolute;
	 width: 95%;
	 height:calc(85% - 0px);
     }
    </style>

    <!-- <div class="card">     <!-- "card" not displayed ??  needed? -->
    <div>
	<h1>Polymer google-maps-api extended example</h1>
	<!-- <div id="map"> -->  <!-- displays two google maps, one small and one as per #map -->
	<!-- moved id="map" to <google-maps=api> -required to get correctly sized map -->
	<google-maps-api id="map" on-api-load="loaded" api-key="AIzaSyCy71TCJa_xLJQbCCdZu4dtYMNh8Nav7zw"
			 version="3.exp">
	</google-maps-api>
    </div>
  </template>

  <script>
   class MyView3 extends Polymer.Element {
//   class MyView3 extends HTMLElement {
       static get is() { return 'my-view3'; }

       static get properties() {
	    return {
		pos: {
		    type: Number,
		    notify: true,
		    value: null
		}
	    }
       }
       
       ready() {
	   super.ready();
	   console.log('begin super.ready');
	   //var mapsAPI = document.querySelector('google-maps-api');
	   var mapsAPI = this.shadowRoot.querySelector('google-maps-api');
	   mapsAPI.addEventListener('api-load', function(e) {
	       console.log('this.api');
	       console.log(this.api);
	       var pos = {lat: 47.1899, lng: 8.8219};
	       var map = new google.maps.Map(mapsAPI, {
		   //center: {lat: 47.190215, lng: 8.821755},
		   center: pos,
		   zoom: 13,
		   tilt: 45,  //seems to be default
		   mapTypeId: 'satellite',
		   fullscreenControl: true,
		   streetViewControl: false,
	       });

	       var marker = new google.maps.Marker({                
		   map: map,
		   position: pos,
		   title: 'Maienberg',
		   draggable: true,
	       });

	       var planCoordinates = [
		   {lat: 47.19056, lng: 8.82532},
		   {lat: 47.18997, lng: 8.82302},
		   {lat: 47.18994, lng: 8.82180},
		   {lat: 47.18896, lng: 8.81960}
	       ];
	       var alignment = new google.maps.Polyline({
		   path: planCoordinates,
		   geodesic: true,
		   strokeColor: '#FF0000',
		   strokeOpacity: 1.0,
		   strokeWeight: 2,
		   map: map,
	       });
	       //alignment.setMap(map);   //useful to redisplay changed alignment?



	       
	   });
	   console.log('ready');
       }

       loaded() {
	   console.log('google-maps-api loaded');
       }
   }

   window.customElements.define(MyView3.is, MyView3);   
  </script>
</dom-module>
